{"ast":null,"code":"import axios from'axios';// const API_URL = 'http://127.0.0.1:8000/api'; \nconst API_URL='https://159.89.11.142/api';const getToken=()=>{return localStorage.getItem('access_token');};const getUserProfile=async()=>{const token=getToken();if(!token){return null;}try{const response=await axios.get(\"\".concat(API_URL,\"/profile/\"),{headers:{Authorization:\"Bearer \".concat(token)}});return response.data;}catch(error){if(error.response&&error.response.status===401){handleLogout();}throw error;}};const login=async(username,password)=>{try{const response=await axios.post(\"\".concat(API_URL,\"/token/\"),{username,password});localStorage.setItem('access_token',response.data.access);localStorage.setItem('refresh_token',response.data.refresh);// Redirect to home or dashboard page\nwindow.location.href='/';// Change to your desired route\n}catch(error){if(error.response){// Server responded with a status other than 200 range\nthrow new Error('Invalid username or password');}else if(error.request){// Request was made but no response was received\nthrow new Error('Network error, please try again later');}else{// Something happened in setting up the request that triggered an Error\nthrow new Error('An error occurred, please try again later');}}};const register=async(username,email,password)=>{try{const response=await axios.post(\"\".concat(API_URL,\"/register/\"),{username,email,password},{headers:{'Content-Type':'application/json'}});return response.data;}catch(error){throw new Error(error.response.data.message||error.message);}};const handleLogout=async()=>{// Remove tokens from localStorage\nlocalStorage.removeItem('access_token');localStorage.removeItem('refresh_token');localStorage.removeItem('user');const refreshToken=localStorage.getItem('refresh_token');//  inform the server\ntry{await axios.post(\"\".concat(API_URL,\"/logout/\"),{refresh_token:refreshToken});}catch(error){console.error('Error during logout: ',error);}// Redirect to login page or home page\nwindow.location.href='/login';// or any other route\n};const getAllCourses=async()=>{const response=await axios.get(\"\".concat(API_URL,\"/courses/\"));return response.data;};const getAllProfiles=async()=>{const response=await axios.get(\"\".concat(API_URL,\"/profiles/\"));return response.data;};const getCourse=async courseId=>{const response=await axios.get(\"\".concat(API_URL,\"/courses/\").concat(courseId,\"/\"));return response.data;};const searchCourses=async params=>{const response=await axios.get(\"\".concat(API_URL,\"/courses/search/\"),{params,paramsSerializer:params=>{return Object.entries(params).map(_ref=>{let[key,value]=_ref;return Array.isArray(value)?value.map(v=>\"\".concat(key,\"=\").concat(encodeURIComponent(v))).join('&'):\"\".concat(key,\"=\").concat(encodeURIComponent(value));}).join('&');}});return response.data;};export default{getUserProfile,login,handleLogout,searchCourses,getAllCourses,getCourse,getAllProfiles,register};","map":{"version":3,"names":["axios","API_URL","getToken","localStorage","getItem","getUserProfile","token","response","get","concat","headers","Authorization","data","error","status","handleLogout","login","username","password","post","setItem","access","refresh","window","location","href","Error","request","register","email","message","removeItem","refreshToken","refresh_token","console","getAllCourses","getAllProfiles","getCourse","courseId","searchCourses","params","paramsSerializer","Object","entries","map","_ref","key","value","Array","isArray","v","encodeURIComponent","join"],"sources":["/Users/seidkrsic/Desktop/Sigma/SigmaFront/sigma/src/services/api.jsx"],"sourcesContent":["import axios from 'axios';\n\n\n// const API_URL = 'http://127.0.0.1:8000/api'; \n\nconst API_URL = 'https://159.89.11.142/api'\n\n\nconst getToken = () => {\n    return localStorage.getItem('access_token');\n  };\n  \n\nconst getUserProfile = async () => {\n    const token = getToken();\n    if (!token) {\n        return null;\n    }\n\n    try {\n        const response = await axios.get(`${API_URL}/profile/`, {\n        headers: {\n            Authorization: `Bearer ${token}`\n        }\n        });\n        return response.data;\n    } catch (error) {\n        if (error.response && error.response.status === 401) {\n        handleLogout();\n        }\n        throw error;\n    }\n};\n\n\n  \n\nconst login = async (username, password) => {\n    try {\n        const response = await axios.post(`${API_URL}/token/`, {\n            username,\n            password,\n        });\n        localStorage.setItem('access_token', response.data.access);\n        localStorage.setItem('refresh_token', response.data.refresh);\n        // Redirect to home or dashboard page\n        window.location.href = '/'; // Change to your desired route\n    } catch (error) {\n        if (error.response) {\n        // Server responded with a status other than 200 range\n        throw new Error('Invalid username or password');\n        } else if (error.request) {\n        // Request was made but no response was received\n        throw new Error('Network error, please try again later');\n        } else {\n        // Something happened in setting up the request that triggered an Error\n        throw new Error('An error occurred, please try again later');\n        }\n    }\n    };\n\n\nconst register = async (username, email, password) => {\n    try {\n        const response = await axios.post(`${API_URL}/register/`, {\n        username,\n        email,\n        password,\n        }, {\n                headers: {\n                    'Content-Type': 'application/json'\n                }\n        });\n        return response.data;\n    } catch (error) {\n        throw new Error(error.response.data.message || error.message);\n    }\n    };\n      \n      \nconst handleLogout = async () => {\n\n    // Remove tokens from localStorage\n    localStorage.removeItem('access_token');\n    localStorage.removeItem('refresh_token');\n    localStorage.removeItem('user');\n    const refreshToken = localStorage.getItem('refresh_token');\n    \n    //  inform the server\n    try {\n        await axios.post(`${API_URL}/logout/`, { refresh_token: refreshToken });\n    } catch (error) {\n        console.error('Error during logout: ', error);\n    }\n\n\n    \n    // Redirect to login page or home page\n    window.location.href = '/login'; // or any other route\n};\n \nconst getAllCourses = async () => {\n    const response = await axios.get(`${API_URL}/courses/`);\n    return response.data;\n};   \n\nconst getAllProfiles = async () => {\n    const response = await axios.get(`${API_URL}/profiles/`);\n    return response.data;\n}; \n\nconst getCourse = async (courseId) => {\n    const response = await axios.get(`${API_URL}/courses/${courseId}/`);\n    return response.data;\n}; \n\nconst searchCourses = async (params) => {\n    const response = await axios.get(`${API_URL}/courses/search/`, {\n      params,\n      paramsSerializer: params => {\n        return Object.entries(params)\n          .map(([key, value]) => Array.isArray(value) ? value.map(v => `${key}=${encodeURIComponent(v)}`).join('&') : `${key}=${encodeURIComponent(value)}`)\n          .join('&');\n      }\n    });\n    return response.data;\n  };\n\n\n\n\nexport default {\n    getUserProfile, \n    login,\n    handleLogout, \n    searchCourses, \n    getAllCourses,\n    getCourse,\n    getAllProfiles,\n    register, \n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}